window.repositoryObject = {"parameters":[{"name":"Exam_id","description":null,"mode":"IN","data_type":"int","custom_fields":{},"linked_terms":[]},{"name":"Student_id","description":null,"mode":"IN","data_type":"int","custom_fields":{},"linked_terms":[]},{"name":"answers","description":null,"mode":"IN","data_type":"nvarchar(255)","custom_fields":{},"linked_terms":[]}],"parameters_custom_fields":[],"dependencies":{"uses":[],"used_by":[]},"object_id":"p66","name":"InsertStudentAnswer","subtype":"PROCEDURE","is_user_defined":false,"description":null,"summary":[{"field":"Documentation","value":{"_type":"link","name":"Examination_System_DATA_Dictionary","id":"d2"}},{"field":"Schema","value":"dbo"},{"field":"Name","value":"InsertStudentAnswer"},{"field":"Type","value":"Procedure"}],"script":"CREATE PROCEDURE InsertStudentAnswer\r\n    @Exam_id INT,\r\n    @Student_id INT,\r\n    @answers NVARCHAR(255)\r\nAS\r\nBEGIN\r\n    -- Start transaction\r\n    BEGIN TRANSACTION;\r\n\r\n    Declare @Question_id INT;\r\n    Declare @QOrder INT = 1;\r\n    Declare @choice NVARCHAR(255);\r\n\r\n    -- Declare a cursor for the function result\r\n    DECLARE choice_cursor CURSOR FOR\r\n    SELECT Element FROM dbo.SplitString(@answers, ';');\r\n\t-- Open the cursor\r\nOPEN choice_cursor;\r\nFETCH NEXT FROM choice_cursor INTO @choice;\r\n\r\n-- Loop through each choice and insert into StudentAnswer table\r\nWHILE @@FETCH_STATUS = 0\r\nBEGIN\r\n    -- Insert into StudentAnswer table\r\n    SET @Question_Id = (SELECT Question_Id \r\n                        FROM Examination_System.dbo.ExamQuestion \r\n                        WHERE Exam_Id = @Exam_Id AND Question_Order = @QOrder);\r\n\r\nINSERT INTO Examination_System.dbo.StudentAnswer\r\n    (Student_Id, Exam_Id, Question_Id, Choice)\r\nVALUES\r\n    (@Student_Id, @Exam_Id, @Question_Id, @choice);\r\n\r\n-- Increment the question order\r\nSET @QOrder = @QOrder + 1;\r\n\r\n-- Fetch the next value\r\nFETCH NEXT FROM choice_cursor INTO @choice;\r\n\r\nEND;\r\n\r\n-- Close and deallocate the cursor\r\nCLOSE choice_cursor;\r\nDEALLOCATE choice_cursor;\r\n\r\n-- Commit the transaction\r\nCOMMIT TRANSACTION;\r\nEND;","imported_at":"2025-02-01 01:13"};